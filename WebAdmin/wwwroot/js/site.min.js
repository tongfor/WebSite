var zTreeDropdownMenu=function(){function e(n,t){var i=t&&!t.isParent;return i||alert("只能选择子栏目..."),i}function i(){var h=$.fn.zTree.getZTreeObj(n),f=h.getSelectedNodes(),t="",i="",u,e,o,s;for(f.sort(function(n,t){return n.id-t.id}),u=0,e=f.length;u<e;u++)t+=f[u].name+",",i+=f[u].id+",";t.length>0&&(t=t.substring(0,t.length-1));i.length>0&&(i=i.substring(0,i.length-1));o=$("#classSel");o.attr("value",t);s=$("#ClassId");s.attr("value",i);r()}function o(){var t=$("#classSel"),n=$("#classSel").offset();$("#zTreeDropdownMenu").css({left:n.left+"px",top:n.top+t.outerHeight()+"px"}).slideDown("fast");$("body").bind("mousedown",u)}function r(){$("#zTreeDropdownMenu").fadeOut("fast");$("body").unbind("mousedown",u)}function u(n){n.target.id==="menuBtn"||n.target.id==="zTreeDropdownMenu"||$(n.target).parents("#zTreeDropdownMenu").length>0||r()}function s(n,t,i){if(!i)return null;for(var r=0,u=i.length;r<u;r++)i[r].name=i[r].name.replace(/\.n/g,".");return i}function h(){var t=$.fn.zTree.getZTreeObj(n);t.expandAll(!0);c()}function c(){if(t){var r=$.fn.zTree.getZTreeObj(n),u=r.getNodeByParam("id",t,null);r.selectNode(u,!1,!1);i(event,t,u,!0)}}var f={view:{dblClickExpand:!1,selectedMulti:!1,showLine:!1},async:{enable:!0,url:"/ArticleClass/GetAllArticleClassTreeJsonForzTree?classid=0",type:"post",autoParam:["id=classId"],dataFilter:s},callback:{beforeClick:e,onClick:i,onAsyncSuccess:h}},n="",t=null;return{init:function(t){n=t;$.fn.zTree.init($("#"+t),f);$(".zTreeSel").click(function(){return o(),!1})},setClassId:function(n){t=n}}}();